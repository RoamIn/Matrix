(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{101:function(e,t,a){"use strict";a.r(t);var n=a(39),s=a(4),i=a(5),r=a(7),c=a(6),o=a(8),l=a(0),u=a.n(l),m=a(40),h=a(38),f=a(67),d=a.n(f),p=a(13),v=(a(79),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).search=function(e){a.props.onSearch(e)},a.handleChange=function(e){a.setState({value:e.target.value.trim()})},a.handleSubmit=function(e){e.preventDefault(),a.search(a.state.value)},a.handleClear=function(){a.setState({value:""})},a.state={value:""},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=d.a.parse(window.location.search).title,t=void 0===e?"":e;this.setState({value:t}),this.search(t)}},{key:"render",value:function(){return u.a.createElement("form",{className:"magnet-search-form",onSubmit:this.handleSubmit},u.a.createElement(p.a,{className:"icon icon-search",type:"search"}),u.a.createElement("input",{type:"text",maxLength:"20",placeholder:"Search ...",autoComplete:"off",autoFocus:"autofocus",spellCheck:"false",value:this.state.value,onChange:this.handleChange}),u.a.createElement(p.a,{className:"icon icon-close",type:"close",onClick:this.handleClear,"v-show":"keyword !== ''"}))}}]),t}(l.Component)),g=a(80),y=a.n(g),b=a(82),k=a.n(b),E=a(84),j=a(16),O=a.n(j),C=a(12),N=a.n(C);a(85);var S=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).state={shouldClose:!1},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.duration>0&&(this.closeTimer=setTimeout(function(){e.close()},this.props.duration-300))}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"clearCloseTimer",value:function(){this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null)}},{key:"close",value:function(){var e=this;this.clearCloseTimer();var t=this;t.setState({shouldClose:!0}),this.timer=setTimeout(function(){e.props.onClose&&e.props.onClose(),clearTimeout(t.timer)},300)}},{key:"render",value:function(){var e=this.state.shouldClose,t=this.props,a=t.prefixCls,n=t.type,s=t.iconClass,i=t.content;return u.a.createElement("div",{className:N()([a,{info:"info"===n},{success:"success"===n},{warning:"warning"===n},{error:"error"===n},{leave:e}])},s?u.a.createElement("div",{className:"".concat(a,"-icon")},u.a.createElement("span",{className:N()(["fa",s])})):null,u.a.createElement("div",{className:"".concat(a,"-content")},i))}}]),t}(u.a.Component);S.defaultProps={prefixCls:"notice",duration:3e3,onClose:function(){}};var T=S,_=(a(86),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).state={notices:[],hasMask:!0},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"add",value:function(e){var t=this.state.notices,a=e.key?e.key:e.key=w(),n=!!e.mask&&e.mask;t.filter(function(e){return e.key===a}).length||(t.push(e),this.setState({notices:t,hasMask:n}))}},{key:"remove",value:function(e){this.setState(function(t){return{notices:t.notices.filter(function(t){return t.key!==e})}})}},{key:"getNoticeDOM",value:function(){var e=this,t=this.state.notices,a=[];return t.map(function(t){a.push(u.a.createElement(T,Object.assign({key:t.key},t,{onClose:function(){e.remove(t.key),t.onClose&&t.onClose()}})))}),a}},{key:"getMaskDOM",value:function(){var e=this.state,t=e.notices,a=e.hasMask;if(t.length>0&&!0===a)return u.a.createElement("div",{className:"zby-mask"})}},{key:"render",value:function(){var e=this.props.prefixCls,t=this.getNoticeDOM(),a=this.getMaskDOM();return u.a.createElement("div",{className:e},a,u.a.createElement("div",{className:"".concat(e,"-box")},t))}}]),t}(u.a.Component)),M=0,w=function(){return"notification-"+(new Date).getTime()+"-"+M++};_.reWrite=function(e){var t,a=e||{},n=Object(E.a)({},a);t=document.createElement("div"),document.body.appendChild(t);var s=O.a.render(u.a.createElement(_,n),t);return{notice:function(e){s.add(e)},removeNotice:function(e){s.remove(e)},destroy:function(){O.a.unmountComponentAtNode(t),document.body.removeChild(t)},component:s}},_.defaultProps={prefixCls:"notification"};var x,P=_,D=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;(x||(x=P.reWrite()),x).notice({duration:i,type:e,mask:a,iconClass:n,content:t,onClose:function(){s&&s()}})},L={show:function(e,t,a,n,s){return D(void 0,e,t,a,n,s)},info:function(e,t,a,n,s){return D("info",e,t,a,n,s)},success:function(e,t,a,n,s){return D("success",e,t,a,n,s)},warning:function(e,t,a,n,s){return D("warning",e,t,a,n,s)},error:function(e,t,a,n,s){return D("error",e,t,a,n,s)},loading:function(e){return D(void 0,e||"\u52a0\u8f7d\u4e2d...",!0,"fa-circle-o-notch fa-spin",void 0,0)},hide:function(){x&&(x.destroy(),x=null)}},B=(a(87),function(e){function t(){return Object(s.a)(this,t),Object(r.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(o.a)(t,e),Object(i.a)(t,[{key:"copy",value:function(e){k()(e),L.success("\u590d\u5236\u6210\u529f!")}},{key:"render",value:function(){var e=this;return u.a.createElement("ul",{className:"magnet-list"},this.props.list.map(function(t,a){return u.a.createElement("li",{className:"magnet-list__item",key:a},u.a.createElement("div",{className:"magnet"},u.a.createElement("div",{className:"magnet__content"},u.a.createElement("h4",{className:"magnet__title"},t.title),u.a.createElement("div",{className:"magnet__sub-info"},u.a.createElement("time",{className:"magnet__create-time"},u.a.createElement(p.a,{className:"icon-time",type:"calendar"}),y()(t.created,y.a.ISO_8601).format("YYYY-MM-DD")),u.a.createElement("span",{className:"magnet__size"},u.a.createElement(p.a,{className:"icon-attachment",type:"attachment"}),(t.length/1073741824).toFixed(2)," G"))),u.a.createElement("div",{className:"magnet__attachment"},u.a.createElement("button",{className:"copy-btn",onClick:function(){return e.copy(t.magnet)}},"\u590d\u5236\u78c1\u529b\u94fe\u63a5"))))}))}}]),t}(l.Component)),G=(a(88),window.innerHeight),U=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(c.a)(t).call(this,e))).state={list:[],searchParams:{title:"",page:1},isLoading:!1,noMore:!1,hasError:!1,message:""},a}return Object(o.a)(t,e),Object(i.a)(t,[{key:"setSearchParams",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setState({searchParams:Object.assign(this.state.searchParams,e)})}},{key:"getMagnetByTitle",value:function(){var e=this,t=Object(n.a)({},this.state.searchParams);this.updateLoading(!0),this.setState({hasError:!1,message:""}),setTimeout(function(){Object(h.a)("getMagnetByTitle",t).then(function(t){var a=t.data;e.setState({list:e.state.list.concat(a.list),noMore:0===a.list.length})}).catch(function(t){e.setState({hasError:!0,message:t.message})}).finally(function(){e.updateLoading(!1)})},1e3)}},{key:"search",value:function(e){var t=e.title,a=void 0===t?"":t,n=e.page,s=void 0===n?1:n;this.setState({list:[],title:"",noMore:!1}),this.setSearchParams({title:a,page:s}),this.getMagnetByTitle()}},{key:"nextPage",value:function(){var e=this.state.searchParams.page+1;this.setSearchParams({page:e}),this.getMagnetByTitle()}},{key:"updateLoading",value:function(e){this.setState({isLoading:e})}},{key:"onScroll",value:function(e){if(!(this.state.isLoading||this.state.noMore||this.state.hasError)){var t=e.target,a=t.scrollHeight,n=t.scrollTop;a-G-n<20&&this.nextPage()}}},{key:"render",value:function(){var e=this,t=this.state.isLoading;return u.a.createElement("main",{className:"page-magnet",onScroll:function(t){return e.onScroll(t)}},u.a.createElement(v,{class:"search",keyword:this.state.title,onSearch:function(t){return e.search({title:t})}}),u.a.createElement(B,{list:this.state.list}),t&&u.a.createElement(m.a,{loading:t}),this.state.hasError&&u.a.createElement("div",{className:"error"},this.state.message),!t&&this.state.noMore&&u.a.createElement("div",{className:"no-result"},0===this.state.list.length?"</> There's nothing here ...":"</End>"))}}]),t}(l.Component);t.default=U},38:function(e,t,a){"use strict";var n=a(43),s=a.n(n),i=a(39),r=Object(i.a)({baseURL:""},{getMagnetByTitle:{method:"GET",desc:"\u901a\u8fc7\u6807\u9898\u641c\u7d22\u78c1\u529b\u94fe\u63a5",url:"/api/magnet/getByTitle"}},{search_tags:{method:"GET",desc:"\u6807\u7b7e",url:"/j/search_tags"},search_subjects:{method:"GET",desc:"\u6b63\u5728\u70ed\u6620",url:"/j/search_subjects"},get_movie_detail:{method:"GET",desc:"\u83b7\u53d6\u7535\u5f71\u8be6\u60c5",url:"/rexxar/api/v2/movie/:id",suffix:"id"}}),c=s.a.create({baseURL:r.baseURL,headers:{"Content-Type":"json"}});function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Date.now().toString(16);return Object.assign({},e,{token:t})}c.interceptors.request.use(function(e){switch(e.method){case"put":case"post":case"patch":e.data=o(e.data);break;default:e.params=o(e.data)}return e},function(e){return alert("\u7f51\u7edc\u9519\u8bef\n".concat(e.message)),Promise.reject(e)}),c.interceptors.response.use(function(e){return e.data},function(e){if("undefined"===typeof e.response)return alert("\u7f51\u7edc\u9519\u8bef\n".concat(e.message,"\n").concat(e.config.url)),Promise.reject(e);switch(e.response.status){case 403:alert(403);break;default:alert("\u7f51\u7edc\u9519\u8bef\n".concat(e.response.status,"\n").concat(e.response.config.url))}return Promise.reject(e)});t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r[e],n=r[e],s=n.url,i=n.method;return"undefined"!==typeof a.suffix&&""!==a.suffix&&(s=s.replace(":".concat(a.suffix),t[a.suffix])),c({url:s,method:i,data:t})}},40:function(e,t,a){"use strict";var n=a(4),s=a(5),i=a(7),r=a(6),c=a(8),o=a(0),l=a.n(o),u=a(12),m=a.n(u),h=(a(41),function(e){function t(){return Object(n.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=m()({"c-spin":!0,spinning:this.props.loading});return l.a.createElement("div",{className:e},l.a.createElement("div",{className:"c-spin__box"},l.a.createElement("span",{className:"c-spin__animate"},l.a.createElement("div",{className:"primary primary-red"}),l.a.createElement("div",{className:"primary primary-green"}),l.a.createElement("div",{className:"primary primary-blue"}))))}}]),t}(o.Component));t.a=h},41:function(e,t,a){},79:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){},88:function(e,t,a){}}]);
//# sourceMappingURL=6.e7ccaf96.chunk.js.map